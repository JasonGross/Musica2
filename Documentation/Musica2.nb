(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.0'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     21731,        718]*)
(*NotebookOutlinePosition[     22429,        742]*)
(*  CellTagsIndexPosition[     22385,        738]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell["Musica2", "Title"],

Cell["Documentation on the Musica2 package.", "Text"],

Cell[CellGroupData[{

Cell["Licence", "Subtitle"],

Cell["\<\
Copyright (C) 2004 Bo C. Herlin

This program is free software;you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation;either version 2
of the License,or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY;without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program;if not,write to the Free Software Foundation,
Inc.,59 Temple Place-Suite 330,Boston,MA 02111-1307,USA.\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["History", "Subtitle"],

Cell["\<\
2004-08-08 Bo C. Herlin : added this new state-thing 
2004-08-04 Bo C. Herlin : first release
2004-07-28 Bo C. Herlin : created\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Init", "Subtitle"],

Cell["\<\
Load Musica2 which in turn will load each package when \
needed.\
\>", "Text"],

Cell[BoxData[
    \(<< Musica2`\)], "Input",
  InitializationCell->True],

Cell["\<\
A small example below uses a tiny part of the Audio package when \
creating a triangle sound.\
\>", "Text"],

Cell[BoxData[
    \(<< Miscellaneous`Audio`\)], "Input",
  InitializationCell->True],

Cell["Set DataFolder to the folder containing the testfiles.", "Text"],

Cell[BoxData[
    \(\(DataFolder = "\<Musica2/Documentation/Data/\>";\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(\(\(cor := DataFolder <> "\<cor.mid\>"\) \)\(;\)\( (*\ 2.9  kb, \ 
      J . S . Bach, \ bwv\ 323, \ choral, \ Holy, \ 
      holy, \ \(\(holy\)\(.\)\)\ *) \)\(\[IndentingNewLine]\)\(\(fug := 
        DataFolder <> "\<fug.mid\>"\) \)\(;\)\( (*\ 6.1  kb, \ 
      J . S . Bach, \ bwv\ 846  b, \ fugue\ 1\ in\ C\ major, \ 
      wtc1\ *) \)\(\[IndentingNewLine]\)\(\(cun := 
        DataFolder <> "\<cun.mid\>"\) \)\(;\)\( (*\ 6.4  kb, \ 
      J . S . Bach, \ bwv\ 1080  a, \ contrapunctus\ 1, \ 
      cunst\ die\ fugue\ *) \)\(\[IndentingNewLine]\)\(\(pre := 
        DataFolder <> "\<pre.mid\>"\) \)\(;\)\( (*\ 8.9  kb, \ 
      J . S . Bach, \ bwv\ 847  a, \ preludium\ 2\ in\ C\ minor, \ 
      wtc1\ *) \)\)\)], "Input",
  InitializationCell->True],

Cell["Set MidiTestFile to the file to apply the tests to.", "Text"],

Cell[BoxData[{
    \(\(MidiTestFile := cor;\)\), "\[IndentingNewLine]", 
    \(\(MidiTestFileList := {cor, fug, cun, pre};\)\)}], "Input",
  InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Tour of Musica2", "Subtitle"],

Cell["Ok", "Text"],

Cell[CellGroupData[{

Cell["Midi", "Subsubtitle"],

Cell["Read from a SMF (StandardMidiFile).", "Text"],

Cell[BoxData[
    \(m = MidiImportSMF[MidiTestFile]\)], "Input"],

Cell["\<\
Midi contain two parts: info and music. Info is a list of rules \
with values for different attributes and music is the midi-data whos \
structure depends on info.\
\>", "Text"],

Cell["\<\
Info contain rules for each attribute:
\tMidiFileFormat (0 or 1),if omitted defaults to Options[Midi]
\tMidiShape (MidiFile,MidiVoice or MidiChord)
\tMidiTimeUnit (MidiTick or MidiSec)
\tMidiTiming (MidiDelta or MidiAbsolute)
\tMidiTPQ (TickPerQuarter),if omitted defaults to Options[Midi]
\tMidiQPM (QuarterPerMinute),if omitted defaults to Options[Midi], used as \
default tempo\
\>", "Text"],

Cell[BoxData[
    \(MidiGetInfo[m]\)], "Input"],

Cell[BoxData[
    \(Options[Midi]\)], "Input"],

Cell["\<\
The info-parts MidiShape, MidiTimeUnit and MidiTiming are called \
the State.\
\>", "Text"],

Cell[BoxData[
    \(MidiGetState[m]\)], "Input"],

Cell["Write to a SMF.", "Text"],

Cell[BoxData[
    \(MidiExportSMF["\<tmp.mid\>", m]\)], "Input"],

Cell["Create a list of Midi's to test on.", "Text"],

Cell[BoxData[
    \(ml = MidiImportSMF /@ MidiTestFileList\)], "Input"],

Cell["Do the files contain EOT (EndOfTrack)?", "Text"],

Cell[BoxData[
    \(\(# === MidiAddEOT[#] &\) /@ ml\)], "Input"],

Cell["What are the lengths of the tracks?", "Text"],

Cell[BoxData[
    \(MidiGetDurations /@ ml // ColumnForm\)], "Input"],

Cell["Equalize them.", "Text"],

Cell[BoxData[
    \(\(MidiGetDurations[MidiEqualizeEOT[#]] &\) /@ ml // 
      ColumnForm\)], "Input"],

Cell["What are the lengths of the files?", "Text"],

Cell[BoxData[
    \(MidiGetDuration /@ ml\)], "Input"],

Cell["On which channels per track are there notes?", "Text"],

Cell[BoxData[
    \(\(MidiGetChannels[#] &\) /@ ml // ColumnForm\)], "Input"],

Cell["\<\
Do the files use NoteOff's instead of NoteOn's with velocity \
zero?\
\>", "Text"],

Cell[BoxData[
    \(\(# === MidiNormalizeNoteOff[#] &\) /@ ml\)], "Input"],

Cell["\<\
If a second parameter is supplied you can turn all \
NoteOff-velocitys to zero.\
\>", "Text"],

Cell["\<\
Currently, some of the functions just called above only work if the \
Midi-object has shape MidiFile.\
\>", "Text"],

Cell["\<\
Since changing to shape MidiVoice is neglecting velocity for \
NoteOff's I'll set them all to zero so that I can check for any loss \
easier.\
\>", "Text"],

Cell[BoxData[
    \(m = MidiNormalizeNoteOff[m, True]\)], "Input"],

Cell["\<\
When shape is MidiFile the music-part is a list of tracks \
containing events as {timing, {type, data}}.\
\>", "Text"],

Cell["\<\
Type is always an integer, except if the event is a meta-event, \
then its a list as {255,integer}.\
\>", "Text"],

Cell[BoxData[
    \(m[\([2]\)] // ColumnForm\)], "Input"],

Cell["\<\
This looks very much like an EventList in the original \
musica-package.\
\>", "Text"],

Cell["Change shape to MidiVoice the possibly depricated way.", "Text"],

Cell[BoxData[
    \(mv = MidiSetShape[m, MidiVoice]\)], "Input"],

Cell["Change shape to MidiVoice the new way.", "Text"],

Cell[BoxData[
    \(mv = MidiSetState[m, {MidiShape \[Rule] MidiVoice}]\)], "Input"],

Cell["\<\
When shape is MidiVoice the music-part is a list of voices \
containing data as {{type, track},{{timing, data}...}}.\
\>", "Text"],

Cell["There is no type MidiNoteOff in shape voice.", "Text"],

Cell["\<\
If the voice contains notes, type MidiNoteOn, track is not just a \
number but a list as {track,channel,voice}. (Im not sure if the voice-nr-info \
is useful, I might remove it).\
\>", "Text"],

Cell["\<\
If the voice contains notes, the data is {timing,{pitch,velocity}} \
since channel is added to the track-info, se above.\
\>", "Text"],

Cell["\<\
A negative velocity means a rest and the pitch is the pitch of the \
previous note not being a rest. The data for a rest is discarded when \
changing back to shape MidiFile. (Maybe ill put a MidiRest symbol in place of \
the {pitch, -velocity}, but then we will have trouble later on, keep \
reading...)\
\>", "Text"],

Cell[BoxData[
    \(mv[\([2]\)] // ColumnForm\)], "Input"],

Cell["\<\
Change shape back to MidiFile again the possibly depricated \
way.\
\>", "Text"],

Cell[BoxData[
    \(mf = MidiSetShape[mv, MidiFile]\)], "Input"],

Cell["Change shape back to MidiFile again the new way.", "Text"],

Cell[BoxData[
    \(mf = MidiSetState[mv, {MidiShape -> MidiFile}]\)], "Input"],

Cell["\<\
What did we miss? (nothing if you used my testfile) (TODO: All \
channel messages except notes are currently discarded when changing to shape \
MidiVoice).\
\>", "Text"],

Cell[BoxData[
    \(MapThread[Complement, {m[\([2]\)], mf[\([2]\)]}] // 
      ColumnForm\)], "Input"],

Cell["\<\
What did we add? This should at least be all empty for all \
testfiles.\
\>", "Text"],

Cell[BoxData[
    \(MapThread[Complement, {mf[\([2]\)], m[\([2]\)]}] // 
      ColumnForm\)], "Input"],

Cell["Next shape is MidiChord, the possibly depricated way.", "Text"],

Cell[BoxData[
    \(mc = MidiSetShape[mv, MidiChord]\)], "Input"],

Cell["Next shape is MidiChord, the new way.", "Text"],

Cell[BoxData[
    \(mc = MidiSetState[mv, {MidiShape \[Rule] MidiChord}]\)], "Input"],

Cell["\<\
When shape is MidiChord the music-part is a list containing data as \
{{type, {track...}},{{timing, {data...}}...}} for each type.\
\>", "Text"],

Cell["There is no type MidiNoteOff in shape chord.", "Text"],

Cell["\<\
The data is negated if there is a tie. (I might change this to be \
the symbol MidiTie, as I might do with MidiRest, but problems will arise, \
read on...)\
\>", "Text"],

Cell[BoxData[
    \(mc[\([2]\)] // ColumnForm\)], "Input"],

Cell["\<\
Get the list of all chords. Negative pitch means tie. Rest's dont \
show up here, they are indicated by the velocity-part. (This wouldnt be \
doable if we had MidiRest and MidiTie instead of negated data)\
\>", "Text"],

Cell[BoxData[
    \(\(\(Transpose[#]\)[\([1]\)] &\) /@ \(Transpose[
          mc[\([2, 1, 2]\)]]\)[\([2]\)]\)], "Input"],

Cell["\<\
We can use supplied patterns to check the data. Not much of a test \
yet really, but the sourcecode of the patterns may help a confused \
programmer.\
\>", "Text"],

Cell["We can check the info part.", "Text"],

Cell[BoxData[
    \(\(MatchQ[#[\([1]\)], MidiPatternInfo] &\) /@ {mf, mv, mc}\)], "Input"],

Cell["We can check the music part.", "Text"],

Cell[BoxData[
    \(\(MatchQ[#[\([2]\)], MidiPatternFile] &\) /@ {mf, mv, mc}\)], "Input"],

Cell[BoxData[
    \(\(MatchQ[#[\([2]\)], MidiPatternVoice] &\) /@ {mf, mv, mc}\)], "Input"],

Cell[BoxData[
    \(\(MatchQ[#[\([2]\)], MidiPatternChord] &\) /@ {mf, mv, mc}\)], "Input"],

Cell["Or we can check the whole package so to speak.", "Text"],

Cell[BoxData[
    \(\(MatchQ[#, MidiPatternMidi] &\) /@ {mf, mv, mc}\)], "Input"],

Cell["\<\
Change TimeUnit to MidiSec and then get the duration in sec, the \
possibly depricated way.\
\>", "Text"],

Cell[BoxData[
    \(\(MidiGetDuration[MidiSetTimeUnit[#, MidiSec]] &\) /@ ml\)], "Input"],

Cell["\<\
Change TimeUnit to MidiSec and then get the duration in sec, the \
new way.\
\>", "Text"],

Cell[BoxData[
    \(\(MidiGetDuration[MidiSetState[#, {MidiTimeUnit \[Rule] MidiSec}]] &\) /@ 
      ml\)], "Input"],

Cell["Get all tempo-changes and their starting time.", "Text"],

Cell[BoxData[
    \(Round[N[MidiGetQPM /@ ml]] // ColumnForm\)], "Input"],

Cell["\<\
Three simple ways of creating Midi-objects with random notes \
getting slightly different results.\
\>", "Text"],

Cell[BoxData[
    \(\(\(NRT = 4;\)\( (*\ nr\ of\ tracks\ *) \)\)\)], "Input"],

Cell[BoxData[
    \(\(\(NRN = 100;\)\( (*\ nr\ of\ notes\ per\ track\ *) \)\)\)], "Input"],

Cell["Create a Midi object in shape file.", "Text"],

Cell[BoxData[
    \(m1 = 
      Midi[\[IndentingNewLine]{MidiShape \[Rule] MidiFile, 
          MidiTimeUnit \[Rule] MidiTick, 
          MidiTiming \[Rule] 
            MidiAbsolute}, \[IndentingNewLine]Join[\[IndentingNewLine]{{}},  \
(*\ empty\ master\ track\ *) \[IndentingNewLine]\(Flatten[#, 1] &\) /@ 
            Table[\[IndentingNewLine]Module[{s = Random[Integer, {0, 10000}], 
                  c = Random[Integer, {0, 15}], 
                  p = Random[Integer, {0, 127}], 
                  v = Random[Integer, {1, 127}], 
                  d = Random[
                      Integer, {1, 
                        100}]}, \[IndentingNewLine]{{s, {MidiNoteOn, {c, p, 
                        v}}}, {s + 
                      d, {MidiNoteOff, {c, p, 
                        0}}}}\[IndentingNewLine]], \[IndentingNewLine]{t, 
                NRT}, {i, 
                NRN}\[IndentingNewLine]]\[IndentingNewLine]]\
\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \(MatchQ[m1[\([2]\)], MidiPatternFile]\)], "Input"],

Cell["Create a Midi object in shape voice.", "Text"],

Cell[BoxData[
    \(m2 = 
      Midi[\[IndentingNewLine]{MidiShape \[Rule] MidiVoice, 
          MidiTimeUnit \[Rule] MidiTick, 
          MidiTiming \[Rule] 
            MidiAbsolute}, \
\[IndentingNewLine]Table[\[IndentingNewLine]Module[{c = 
                Random[Integer, {0, 
                    15}]}, \[IndentingNewLine]{{MidiNoteOn, {t, c, 
                  1}}, \[IndentingNewLine]Flatten[
                Table[\[IndentingNewLine]Module[{s = 
                        Random[Integer, {0, 10000}], 
                      p = Random[Integer, {0, 127}], 
                      v = Random[Integer, {1, 127}], 
                      d = Random[
                          Integer, {1, 100}]}, \[IndentingNewLine]{{d, {p, 
                          v}}, {d + 
                          s, {p, \(-v\)}}}\[IndentingNewLine]], \
\[IndentingNewLine]{i, NRN}\[IndentingNewLine]], 
                1]\[IndentingNewLine]}\[IndentingNewLine]], \
\[IndentingNewLine]{t, 
            NRT}\[IndentingNewLine]]\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \(MatchQ[m2[\([2]\)], MidiPatternVoice]\)], "Input"],

Cell["Create a Midi object in shape chord.", "Text"],

Cell[BoxData[
    \(m3 = 
      Midi[\[IndentingNewLine]{MidiShape \[Rule] MidiChord, 
          MidiTimeUnit \[Rule] MidiTick, 
          MidiTiming \[Rule] 
            MidiDelta}, \[IndentingNewLine]{{{MidiNoteOn, 
              Table[Module[{c = Random[Integer, {0, 15}]}, {t, c, 1}], {t, 
                  NRT}]}, \
\[IndentingNewLine]Table[\[IndentingNewLine]Module[{d = 
                    Random[Integer, {1, 
                        100}]}, \[IndentingNewLine]{\[IndentingNewLine]d, \
\[IndentingNewLine]Table[\[IndentingNewLine]Module[{p = 
                          Random[Integer, {0, 127}], 
                        v = Random[
                            Integer, {1, 127}]}, \[IndentingNewLine]{p, 
                        v}\[IndentingNewLine]], \[IndentingNewLine]{t, 
                      NRT}\[IndentingNewLine]]\[IndentingNewLine]}\
\[IndentingNewLine]], \[IndentingNewLine]{i, 
                NRN}\[IndentingNewLine]]\[IndentingNewLine]}}\
\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \(MatchQ[m3[\([2]\)], MidiPatternChord]\)], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sound", "Subsubtitle"],

Cell["Start with a function taking sec as parameter.", "Text"],

Cell[BoxData[
    \(f = Sin[2  Pi\ 220\ #] &\)], "Input"],

Cell[BoxData[
    \(Plot[f[t], {t, 0, 0.01}]\)], "Input"],

Cell["Make a 1 sec sound-function-object.", "Text"],

Cell[BoxData[
    \(s = SoundMakeFunc[f, SoundDuration \[Rule] 1]\)], "Input"],

Cell[BoxData[
    \(Show[s]\)], "Input"],

Cell["Make a sound using the Audio-package.", "Text"],

Cell[BoxData[
    \(s = Waveform[Triangle, 220, 0.5]\)], "Input"],

Cell[BoxData[
    \(Show[s]\)], "Input"],

Cell["Get the function.", "Text"],

Cell[BoxData[
    \(f = \(SoundGetFunc[s]\)[\([1]\)]\)], "Input"],

Cell[BoxData[
    \(Plot[f[t], {t, 0, 0.01}]\)], "Input"],

Cell["Convert sample-rate.", "Text"],

Cell[BoxData[
    \(s = SoundMakeFunc[s, SampleRate \[Rule] 2^12]\)], "Input"],

Cell[BoxData[
    \(Show[s]\)], "Input"],

Cell["Make it into a sound-sample-list.", "Text"],

Cell[BoxData[
    \(s = SoundMakeList[s]\)], "Input"],

Cell[BoxData[
    \(Show[s]\)], "Input"],

Cell["Get the function (which is really a list now).", "Text"],

Cell[BoxData[
    \(\(f = \(SoundGetFunc[s]\)[\([1]\)];\)\)], "Input"],

Cell[BoxData[
    \(Plot[f[t], {t, 0, 0.01}]\)], "Input"],

Cell["Do it again, but smothen the curve.", "Text"],

Cell[BoxData[
    \(\(f = \(SoundGetFunc[s, 
            SoundSmooth \[Rule] True]\)[\([1]\)];\)\)], "Input"],

Cell[BoxData[
    \(Plot[f[t], {t, 0, 0.01}]\)], "Input"],

Cell["Start with two sounds.", "Text"],

Cell[BoxData[
    \(sa = SoundMakeFunc[Sin[2  Pi\ 220\ #] &, SoundDuration \[Rule] 1]; 
    sb = SoundMakeFunc[Sin[2  Pi\ 220\ 3/2\ #] &, 
        SoundDuration \[Rule] 1];\)], "Input"],

Cell["Make a sound by combining them in paralell.", "Text"],

Cell[BoxData[
    \(sp = SoundPar[{sa, sb}]\)], "Input"],

Cell[BoxData[
    \(Show[sp]\)], "Input"],

Cell["\<\
Make a sound by combining them in sequence, just like \
Beethowen...\
\>", "Text"],

Cell[BoxData[
    \(ss = SoundSeq[{sa, sb}]\)], "Input"],

Cell[BoxData[
    \(Show[ss]\)], "Input"],

Cell["Make a sound by combining sound in paralell and in sequence.", "Text"],

Cell[BoxData[
    \(ssp = SoundSeq[{SoundPar[{sa, sb}], SoundPar[{sb, sa}]}]\)], "Input"],

Cell[BoxData[
    \(Show[ssp]\)], "Input"],

Cell["Slice it up...", "Text"],

Cell[BoxData[
    \(ssl = SoundUnSeq[ssp, {0.7, 1.1}]\)], "Input"],

Cell["...and take the portion from the middle.", "Text"],

Cell[BoxData[
    \(sm = ssl[\([2]\)]\)], "Input"],

Cell[BoxData[
    \(Show[sm]\)], "Input"],

Cell[BoxData[
    \(sd = SoundImportWav[DataFolder <> "\<lin8.wav\>"]\)], "Input"],

Cell[BoxData[
    \(SoundGetInfo[sd]\)], "Input"],

Cell[BoxData[
    \(Show[sd]\)], "Input"],

Cell["Now, lets make a simple Midi to Sound converter.", "Text"],

Cell[BoxData[
    \(MidiToSound[m : Midi[_, _], 
        opts___] := \[IndentingNewLine]Module[\[IndentingNewLine]{\
\[IndentingNewLine]p2f = 
            Function[p, 
              440*2^\((\((p - 57)\)/12)\)], \[IndentingNewLine]v2a = 
            Function[v, v/127], \[IndentingNewLine]osc = 
            Function[{f, a}, N[a\ Sin[2  Pi\ f  #]] &], \[IndentingNewLine]r, 
          c, mix\[IndentingNewLine]}, \[IndentingNewLine] (*\ 
          get\ the\ music\ as\ {{{timing, {p, 
                        v}} ... } ... }\ *) \[IndentingNewLine] (*\ \(the\ \
old\ way\ r = 
              Cases[\(MidiSetTiming[
                    MidiSetShape[MidiSetTimeUnit[m, MidiSec], MidiVoice], 
                    MidiDelta]\)[\([2]\)], {{MidiNoteOn, _}, d$_} \[Rule] 
                  d$];\)\ *) \[IndentingNewLine] (*\ 
          get\ the\ music\ as\ {{{timing, {p, 
                        v}} ... } ... }\ *) \[IndentingNewLine]r = 
          Cases[\(MidiSetState[
                m, {MidiTimeUnit \[Rule] MidiSec, 
                  MidiShape \[Rule] MidiVoice, 
                  MidiTiming \[Rule] 
                    MidiDelta}]\)[\([2]\)], {{MidiNoteOn, _}, d$_} \[Rule] 
              d$]; \[IndentingNewLine] (*\ 
          make\ them\ into\ lists\ of\ sound - 
            objects\ *) \[IndentingNewLine]r = \(\((\[IndentingNewLine]\(If[
                      0 < #[\([2, 2]\)], \[IndentingNewLine]SoundMakeFunc[
                        osc[p2f[#[\([2, 1]\)]], v2a[#[\([2, 2]\)]]], 
                        SoundDuration \[Rule] #[\([1]\)], 
                        opts], \[IndentingNewLine]SoundOfSilence[
                        SoundChannelCount -> 1, 
                        SoundDuration \[Rule] #[\([1]\)], 
                        opts]\[IndentingNewLine]] &\) /@ \
#\[IndentingNewLine])\) &\) /@ r; \[IndentingNewLine] (*\ 
          then\ use\ SoundSeq\ *) \[IndentingNewLine]r = 
          SoundSeq /@ r; \[IndentingNewLine] (*\ 
          then\ use\ SoundPar\ *) \[IndentingNewLine]r = 
          SoundPar[r]; \[IndentingNewLine] (*\ 
          create\ a\ simple\ mix\ for\ two\ output - 
            channels\ *) \[IndentingNewLine]c = 
          SoundGetChannelCount[r]; \[IndentingNewLine]mix = 
          Table[N[{Evaluate[\((c - i)\)/\((2 \((c - 1)\))\)] &, 
                Evaluate[\((i - 1)\)/\((2 \((c - 1)\))\)] &}], {i, 
              c}]; \[IndentingNewLine] (*\ 
          make\ the\ mixdown\ *) \[IndentingNewLine]SoundMix[r, 
          mix]\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \(m2s = MidiToSound[m]\)], "Input"],

Cell[BoxData[
    \(SoundGetInfo[m2s]\)], "Input"],

Cell["\<\
This takes a while to render, partly because a Sound of type \
SampledSoundFunction with two channels must contain a list of two functions \
returning one value each instead of a single function returning a list of two \
values. On my laptop, 1GHz, it takes about 55 sec.\
\>", "Text"],

Cell[BoxData[
    \(Show[m2s]\)], "Input"],

Cell["\<\
Now, lets hear our 3rd random composition (m3 takes 9 sec to \
convert and render, m1 and m2 takes much, much longer):\
\>", "Text"],

Cell[BoxData[
    \(Show[MidiToSound[m3]]\)], "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
FrontEndVersion->"5.0 for X",
ScreenRectangle->{{0, 1600}, {0, 1200}},
AutoGeneratedPackage->Automatic,
WindowSize->{1153, 1095},
WindowMargins->{{0, Automatic}, {Automatic, 16}},
StyleDefinitions -> "Default.nb"
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1776, 53, 24, 0, 96, "Title"],
Cell[1803, 55, 53, 0, 32, "Text"],

Cell[CellGroupData[{
Cell[1881, 59, 27, 0, 51, "Subtitle"],
Cell[1911, 61, 720, 16, 284, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[2668, 82, 27, 0, 51, "Subtitle"],
Cell[2698, 84, 151, 4, 68, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[2886, 93, 24, 0, 51, "Subtitle"],
Cell[2913, 95, 88, 3, 32, "Text"],
Cell[3004, 100, 72, 2, 27, "Input",
  InitializationCell->True],
Cell[3079, 104, 117, 3, 32, "Text"],
Cell[3199, 109, 84, 2, 27, "Input",
  InitializationCell->True],
Cell[3286, 113, 70, 0, 32, "Text"],
Cell[3359, 115, 112, 2, 27, "Input",
  InitializationCell->True],
Cell[3474, 119, 775, 13, 75, "Input",
  InitializationCell->True],
Cell[4252, 134, 67, 0, 32, "Text"],
Cell[4322, 136, 166, 3, 43, "Input",
  InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{
Cell[4525, 144, 35, 0, 53, "Subtitle"],
Cell[4563, 146, 18, 0, 32, "Text"],

Cell[CellGroupData[{
Cell[4606, 150, 27, 0, 31, "Subsubtitle"],
Cell[4636, 152, 51, 0, 32, "Text"],
Cell[4690, 154, 64, 1, 27, "Input"],
Cell[4757, 157, 187, 4, 32, "Text"],
Cell[4947, 163, 404, 9, 140, "Text"],
Cell[5354, 174, 47, 1, 27, "Input"],
Cell[5404, 177, 46, 1, 27, "Input"],
Cell[5453, 180, 101, 3, 32, "Text"],
Cell[5557, 185, 48, 1, 27, "Input"],
Cell[5608, 188, 31, 0, 32, "Text"],
Cell[5642, 190, 64, 1, 27, "Input"],
Cell[5709, 193, 51, 0, 32, "Text"],
Cell[5763, 195, 71, 1, 27, "Input"],
Cell[5837, 198, 54, 0, 32, "Text"],
Cell[5894, 200, 64, 1, 27, "Input"],
Cell[5961, 203, 51, 0, 32, "Text"],
Cell[6015, 205, 69, 1, 27, "Input"],
Cell[6087, 208, 30, 0, 32, "Text"],
Cell[6120, 210, 102, 2, 27, "Input"],
Cell[6225, 214, 50, 0, 32, "Text"],
Cell[6278, 216, 54, 1, 27, "Input"],
Cell[6335, 219, 60, 0, 32, "Text"],
Cell[6398, 221, 77, 1, 27, "Input"],
Cell[6478, 224, 92, 3, 32, "Text"],
Cell[6573, 229, 74, 1, 27, "Input"],
Cell[6650, 232, 103, 3, 32, "Text"],
Cell[6756, 237, 125, 3, 32, "Text"],
Cell[6884, 242, 165, 4, 32, "Text"],
Cell[7052, 248, 66, 1, 27, "Input"],
Cell[7121, 251, 128, 3, 32, "Text"],
Cell[7252, 256, 123, 3, 32, "Text"],
Cell[7378, 261, 57, 1, 27, "Input"],
Cell[7438, 264, 96, 3, 32, "Text"],
Cell[7537, 269, 70, 0, 32, "Text"],
Cell[7610, 271, 64, 1, 27, "Input"],
Cell[7677, 274, 54, 0, 32, "Text"],
Cell[7734, 276, 84, 1, 27, "Input"],
Cell[7821, 279, 140, 3, 32, "Text"],
Cell[7964, 284, 60, 0, 32, "Text"],
Cell[8027, 286, 202, 4, 32, "Text"],
Cell[8232, 292, 144, 3, 32, "Text"],
Cell[8379, 297, 327, 6, 50, "Text"],
Cell[8709, 305, 58, 1, 27, "Input"],
Cell[8770, 308, 90, 3, 32, "Text"],
Cell[8863, 313, 64, 1, 27, "Input"],
Cell[8930, 316, 64, 0, 32, "Text"],
Cell[8997, 318, 79, 1, 27, "Input"],
Cell[9079, 321, 179, 4, 32, "Text"],
Cell[9261, 327, 102, 2, 27, "Input"],
Cell[9366, 331, 95, 3, 32, "Text"],
Cell[9464, 336, 102, 2, 27, "Input"],
Cell[9569, 340, 69, 0, 32, "Text"],
Cell[9641, 342, 65, 1, 27, "Input"],
Cell[9709, 345, 53, 0, 32, "Text"],
Cell[9765, 347, 85, 1, 27, "Input"],
Cell[9853, 350, 154, 3, 32, "Text"],
Cell[10010, 355, 60, 0, 32, "Text"],
Cell[10073, 357, 179, 4, 32, "Text"],
Cell[10255, 363, 58, 1, 27, "Input"],
Cell[10316, 366, 228, 4, 32, "Text"],
Cell[10547, 372, 120, 2, 27, "Input"],
Cell[10670, 376, 173, 4, 32, "Text"],
Cell[10846, 382, 43, 0, 32, "Text"],
Cell[10892, 384, 90, 1, 27, "Input"],
Cell[10985, 387, 44, 0, 32, "Text"],
Cell[11032, 389, 90, 1, 27, "Input"],
Cell[11125, 392, 91, 1, 27, "Input"],
Cell[11219, 395, 91, 1, 27, "Input"],
Cell[11313, 398, 62, 0, 32, "Text"],
Cell[11378, 400, 81, 1, 27, "Input"],
Cell[11462, 403, 115, 3, 32, "Text"],
Cell[11580, 408, 89, 1, 27, "Input"],
Cell[11672, 411, 99, 3, 32, "Text"],
Cell[11774, 416, 116, 2, 27, "Input"],
Cell[11893, 420, 62, 0, 32, "Text"],
Cell[11958, 422, 73, 1, 27, "Input"],
Cell[12034, 425, 122, 3, 32, "Text"],
Cell[12159, 430, 77, 1, 27, "Input"],
Cell[12239, 433, 90, 1, 27, "Input"],
Cell[12332, 436, 51, 0, 32, "Text"],
Cell[12386, 438, 960, 19, 219, "Input"],
Cell[13349, 459, 69, 1, 27, "Input"],
Cell[13421, 462, 52, 0, 32, "Text"],
Cell[13476, 464, 1035, 21, 267, "Input"],
Cell[14514, 487, 70, 1, 27, "Input"],
Cell[14587, 490, 52, 0, 32, "Text"],
Cell[14642, 492, 998, 19, 315, "Input"],
Cell[15643, 513, 70, 1, 27, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[15750, 519, 28, 0, 31, "Subsubtitle"],
Cell[15781, 521, 62, 0, 32, "Text"],
Cell[15846, 523, 57, 1, 27, "Input"],
Cell[15906, 526, 57, 1, 27, "Input"],
Cell[15966, 529, 51, 0, 32, "Text"],
Cell[16020, 531, 78, 1, 27, "Input"],
Cell[16101, 534, 40, 1, 27, "Input"],
Cell[16144, 537, 53, 0, 32, "Text"],
Cell[16200, 539, 65, 1, 27, "Input"],
Cell[16268, 542, 40, 1, 27, "Input"],
Cell[16311, 545, 33, 0, 32, "Text"],
Cell[16347, 547, 65, 1, 27, "Input"],
Cell[16415, 550, 57, 1, 27, "Input"],
Cell[16475, 553, 36, 0, 32, "Text"],
Cell[16514, 555, 78, 1, 27, "Input"],
Cell[16595, 558, 40, 1, 27, "Input"],
Cell[16638, 561, 49, 0, 32, "Text"],
Cell[16690, 563, 53, 1, 27, "Input"],
Cell[16746, 566, 40, 1, 27, "Input"],
Cell[16789, 569, 62, 0, 32, "Text"],
Cell[16854, 571, 70, 1, 27, "Input"],
Cell[16927, 574, 57, 1, 27, "Input"],
Cell[16987, 577, 51, 0, 32, "Text"],
Cell[17041, 579, 109, 2, 27, "Input"],
Cell[17153, 583, 57, 1, 27, "Input"],
Cell[17213, 586, 38, 0, 32, "Text"],
Cell[17254, 588, 185, 3, 27, "Input"],
Cell[17442, 593, 59, 0, 32, "Text"],
Cell[17504, 595, 56, 1, 27, "Input"],
Cell[17563, 598, 41, 1, 27, "Input"],
Cell[17607, 601, 92, 3, 32, "Text"],
Cell[17702, 606, 56, 1, 27, "Input"],
Cell[17761, 609, 41, 1, 27, "Input"],
Cell[17805, 612, 76, 0, 32, "Text"],
Cell[17884, 614, 89, 1, 27, "Input"],
Cell[17976, 617, 42, 1, 27, "Input"],
Cell[18021, 620, 30, 0, 32, "Text"],
Cell[18054, 622, 66, 1, 27, "Input"],
Cell[18123, 625, 56, 0, 32, "Text"],
Cell[18182, 627, 50, 1, 27, "Input"],
Cell[18235, 630, 41, 1, 27, "Input"],
Cell[18279, 633, 82, 1, 27, "Input"],
Cell[18364, 636, 49, 1, 27, "Input"],
Cell[18416, 639, 41, 1, 27, "Input"],
Cell[18460, 642, 64, 0, 32, "Text"],
Cell[18527, 644, 2510, 45, 475, "Input"],
Cell[21040, 691, 53, 1, 27, "Input"],
Cell[21096, 694, 50, 1, 27, "Input"],
Cell[21149, 697, 295, 5, 50, "Text"],
Cell[21447, 704, 42, 1, 27, "Input"],
Cell[21492, 707, 142, 3, 32, "Text"],
Cell[21637, 712, 54, 1, 27, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

